<html>
<meta charset="utf-8">
<script src="distill.template.v1.js"></script>
<script type="text/front-matter">
  title: "Better translation for Vietnamese"
  description: "Collect high quality data and train a state-of-the-art Neural Machine Translation model for Vietnamese."
  authors:
  - Chinh Ngo: http://github.com/ntkchinh/
  - Trieu Trinh: http://github.com/thtrieu/
  affiliations:
  - VietAI: https://vietai.org/
  - VietAI: https://vietai.org/
</script>

<script src="syncscroll.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

<style type="text/css">
  
.tab-content>.tab-pane {
  height: 1px;
  overflow: hidden;
  display: block;
 visibility: hidden;
}
.tab-content>.active {
  height: auto;
  overflow: auto;
  visibility: visible;
}
code {
  font-family: Consolas,"courier new";
  color: rgb(37, 35, 35);
  background-color: #f1f1f1;
  padding: 2px;
  font-size: 100%;
}
#left {
  float: left;
  width: 50%;
  height: 100%;
  overflow: auto;
  box-sizing: border-box;
  padding: 0.5em;
}
#right {
  float: left;
  width: 50%;
  height: 100%;
  overflow: auto;
  box-sizing: border-box;
  padding: 0.5em;
}
pre {
  white-space: pre-wrap;       /* Since CSS 2.1 */
  word-break: keep-all
}
a.button {
  display: inline-block;
  background: rgba(255, 255, 255, 0.75);
  padding: 4px 8px;
  border-radius: 4px;
  font-size: 11px!important;
  text-decoration: none;
  color: #aaa;
  border: none;
  font-weight: 300;
  border: solid 1px rgba(0, 0, 0, 0.08);
  border-bottom-color: rgba(0, 0, 0, 0.15);
  text-transform: uppercase;
  line-height: 16px;
}
colablogo {
  background-image: url(colab.svg);
  background-repeat: no-repeat;
  background-size: 20px;
  background-position-y: 2px;
  display: inline-block;
  padding-left: 24px;
  border-radius: 4px;
  text-decoration: none;
}
gcpstoragelogo {
  background-image: url(gcpstorage.svg);
  background-repeat: no-repeat;
  background-size: 20px;
  background-position-y: 0px;
  display: inline-block;
  padding-left: 24px;
  border-radius: 4px;
  text-decoration: none;
}
githublogo {
  background-image: url(github.svg);
  background-repeat: no-repeat;
  background-size: 18px;
  background-position-y: -1px;
  background-position-x: 2px;
  display: inline-block;
  padding-left: 24px;
  border-radius: 4px;
  text-decoration: none;
}
a:hover{
  color: #666;
  background: white;
  border-color: rgba(0, 0, 0, 0.2);
}
</style>

<dt-article>
  <h1>Better translation for Vietnamese</h1>
  <h2>Collect high quality data and train a state-of-the-art Neural Machine Translation model for Vietnamese.</h2>
  <dt-byline></dt-byline>

  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load("current", {
        packages:["corechart", 'bar'],
        // this says that google charts will run (i.e. "callback")
        callback: function() {
            $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
              switch ($(e.target).html()) {
                case 'English to Vietnamese':
                  // this function when the tab is "English to Vietnamese"
                  drawChartEnvi();
                  break;

                case 'Vietnamese to English':
                  // this function when the tab is "Vietnamese to English"
                  drawChartVien();
                  break;
            }});
            drawChartEnvi()
        }
    });

    function drawChartEnvi() {
      var data = google.visualization.arrayToDataTable([
      ['Test set', 'Google Translate', 'Our model'],
      ['Movie subtitles', 19.47, 23.83],
      ['Fictional book', 24.16, 25.82],
      ['Medical publication', 31.99, 38.44],
      ['TED Talk (IWSLT2015)', 37.06, 39.39],
      ['Software', 38.16, 46.85],
      ['Legal documents', 42.76, 56.59]
      ]);
      var options = {
        // title: 'En to Vi Translation',
        chartArea: {width: '70%'},
        legend: { position: "top" },
        colors: ['#75a3a3',
                // '#e085c2'
                // '#FF8C00'
                '#ff9900'
              ],
        hAxis: {
          // title: 'BLEU Score',
          bar: {groupWidth: "70%"},
          ticks: [18, 22, 26, 30, 34, 38, 42, 46, 50, 54, 58],
          minValue: 18,
          viewWindow: {min: 18}
        },
        animation: {
          "startup": true,
          "duration": 1000,
          easing: 'out',
        }
      };
      var chart_envi = new google.visualization.BarChart(document.getElementById('chart_envi'));
      chart_envi.draw(data, options);
    }

    function drawChartVien() {               
      var data = google.visualization.arrayToDataTable([
          ['Test set', 'Google Translate', 'Model của chúng tôi'],
          ['Phụ đề phim', 20.67, 33.67],
          ['Sách truyện', 24.25, 40.52],
          ['Ấn phẩm y học', 25.94, 32.97],
          ['Thuyết trình TED talk', 28.85, 42.75],
          ['Phần mềm', 34.27, 44.04],
          ['Văn bản luật', 30.64, 35.8]
          ]);

      var options = {
        // title: 'Vi to En translation',
        chartArea: {width: '70%'},
        legend: { position: "top" },
        colors: [
                '#75a3a3',
                // '#FF8C00'
                '#ff9900'
          ],
        hAxis: {
          bar: {groupWidth: "70%"},
          ticks: [20, 22, 24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 45],
          minValue: 20,
          viewWindow: {
                  min: 20
              }
        },
        animation: {
            "startup": true,
            "duration": 1000,
            easing: 'out',
        }
      };

      var chart_vien = new google.visualization.BarChart(
          document.getElementById('chart_vien'));
      chart_vien.draw(data, options);
    }

  </script>
  <script type="text/javascript">
    google.charts.load("current", {packages:['corechart', 'bar']});  //"corechart",
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
      var data1 = google.visualization.arrayToDataTable([
      ['Translate from', 'Generic', 'Style-conditioned'],
      ['English to Vietnamese', 40.97, 41.21],
      ['Vietnamese to English', 37.91, 38.34],
      ]);
      var options1 = {
        bar: {groupWidth: "70%"},
        legend: { position: "top" },
        colors: ['#75a3a3',
                // '#e085c2'
                '#ff9900'
              ],
        plotOptions: {
          series: {fillOpacity: 0.1}
        },
        vAxis: {
          // title: 'BLEU Score',
          bar: {groupWidth: "80%"},
          // ticks: [35, 36, 37, 38, 39, 40, 41],
          // minValue: 35,
          viewWindow: {
              min: [35, 41]
              // ,
              // max: [40, 45]
            }
        },
        animation: {
            "startup": true,
            "duration": 1000,
            easing: 'out',
        }
    };
      var chart1 = new google.visualization.ColumnChart(document.getElementById('chart_taguntag'));
      chart1.draw(data1, options1);
  }
  </script>


<p></p>
<p style="text-align:justify">Our model consistently outperforms Google Translate on six different domains.
The following charts showed the two system's quantitative evaluation using
BLEU score - a standard auto-metric in Machine Translation research.
</p>
<ul class="nav nav-tabs">
<li class="active"><a data-toggle="tab" href="#envi">English to Vietnamese</a></li>
<li><a data-toggle="tab" href="#vien">Vietnamese to English</a></li>
</ul>

<div class="tab-content" style="height: 400px;">
<div id="envi" class="tab-pane fade in active">
  <!-- <p></p> -->
  <div id="chart_envi" style="height: 400px;"></div>

  <a href="https://colab.research.google.com/drive/1ISOSve7KrStffohgnjiLFs0cWEYqz9Tc?usp=sharing" 
      class="button" target="_blank" rel="noopener noreferrer">
    Reproduce in <colablogo>Notebook</colablogo></a>

</div>

<div id="vien" class="tab-pane fade">
  <div id="chart_vien" style="height: 400px;">
  
  </div>

  <a href="https://colab.research.google.com/drive/1ISOSve7KrStffohgnjiLFs0cWEYqz9Tc?usp=sharing" 
      class="button" target="_blank" rel="noopener noreferrer">
    Reproduce in <colablogo>Notebook</colablogo></a>

</div>
</div>

<div style="height: 50px;"> </div>

  <div>
  <h2>Introduction</h2>
  <p style="text-align:justify">
    In this work, we aim to solve two problems at the heart of
    Vietnamese Translation: first - poor translation quality due to <b>limited training data</b>,
    and second - generic translation output due to a <b>lack in user interface with the model</b>. 
    We solved them by simply collecting more data, and training our model
    while conditioning its output on specific language styles. 
    We released the resulting models and training data here:
  </p>
  <a href="https://github.com/vietai/SAT" class="button" target="_blank" rel="noopener noreferrer">Get the code at <githublogo>repository</githublogo></a>
  <a href="https://console.cloud.google.com/storage/browser/vietai_public/best_vi_translation" class="button" target="_blank" rel="noopener noreferrer">Download data from <gcpstoragelogo>Storage</gcpstoragelogo></a>
</div>

  <!-- <dt-byline></dt-byline> -->

<div style="height: 10px;"> </div>

  <h2> Collecting more data</h2>
  
  <p style="text-align:justify">We collect data from open sources on the Internet, 
    and classify them into six different categories, each with a 
    specific language style. In total, there are 3.3 million
    pairs of English and Vietnamese texts, ranging from single sentences to paragraphs. 
    Inspect a sample of our test data here:
  </p>

  <ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" id="what" href="#ted">TED talks</a></li>
    <li><a data-toggle="tab" href="#movie">Movie</a></li>
    <li class="tab"><a data-toggle="tab" href="#law">Legal docs</a></li>
    <li class="tab"><a data-toggle="tab" href="#medical">Medical publication</a></li>
    <li class="tab"><a data-toggle="tab" href="#book">Fiction</a></li>
  </ul></div>

  <div class="tab-content" style="height: 315px;">
    <div id="ted" class="tab-pane fade in active">
      <div id="left"><pre id='ted-output' style="height: 300px;" class=syncscroll name=sampleted>
      In South Asia, in countries like India and Pakistan, four species of vultures are listed as critically endangered, which means they have less than 10 or 15 years to go extinct, and the reason is because they are falling prey by consuming livestock that has been treated with a painkilling drug like Diclofenac .

      This drug has now been banned for veterinary use in India, and they have taken a stand .

      Because there are no vultures, there's been a spread in the numbers of feral dogs at carcass dump sites, and when you have feral dogs, you have a huge time bomb of rabies. The number of cases of rabies has increased tremendously in India .

      Kenya is going to have one of the largest wind farms in Africa : 353 wind turbines are going to be up at Lake Turkana .

      I am not against wind energy, but we need to work with the governments, because wind turbines do this to birds. They slice them in half .
        
      </pre></div>
        
      <div id="right"><pre id='ted-output' style="height: 300px;"  class=syncscroll name=sampleted>
      Tại Nam Á, những nước như Ấn Độ và Pakistan, 4 loài kền kền được ghi danh trong danh sách những loài có nguy cơ cực cao điều này có nghĩa là chúng chỉ còn ít hơn 10 hoặc 15 năm để chạm đến mức tuyệt chủng và lí do đó là bởi vì chúng bị biến thành con mồi vì ăn phải gia súc đã được chữa trị bằng thuốc giảm đau như Diclofenac .

      Thuốc này đã bị cấm sử dụng trong ngành thú y tại Ấn Độ. Chúng đã minh chứng rằng
      
      Vì không có kền kền nên mới có sự tràn lan về số lượng chó hoang tại những khu vực chứa rác thải, xác động vật. Khi bạn có chó hoang, bạn có một quả bom hẹn giờ khổng lồ về bệnh dại. Số ca mắc bệnh dại đã tăng rất nhiều tại Ấn Độ .
      
      Kenya sẽ có một cánh đồng quạt gió lớn nhất tại Châu Phi với 353 động cơ sẽ được lắp tại Lake Turkana

      Tôi không phản đối năng lượng gió, nhưng chúng ta cần hợp tác với chính phủ, vì động cơ gió khiến những con chim thành thế này. Chúng bị cắt làm đôi .

      </pre></div>

    </div>
    <div id="movie" class="tab-pane fade">
      
      <div id="left" ><pre id='movie-output' style="height: 300px;" class=syncscroll name=samplemovie>
      Doyle's about halfway through our initial background check. 

      No. We don't insinuate connections we can't back up. 
      
      You should be nearby if President Qian wants to get on the phone. 
      
      Now this is different than the standoff over the Senkaku Islands. 
      
      Well, I'm asking for a small portion of the Seventh Fleet. 
      
      Are you supposed to take the Lord's name in vain like that ? 
      
      The President can issue an executive order in times of emergency. 
      
      There is a heat wave. That always pushes the grid to its limits. 
      
      And good luck with that first pitch tonight, Mr. Vice President. 
      
      This is about the Secretary of State nomination, isn't it ? 
        
      </pre></div>

      <div id="right"><pre id='movie-output' style="height: 300px;"  class=syncscroll name=samplemovie>
      Doyle đang tiến hành kiểm tra lý lịch rồi. 

      Chúng ta sẽ không ám chỉ các mối liên hệ mà ta không thể chứng minh được. 

      Anh nên ở đây nếu chủ tịch Qian muốn trao đổi qua điện thoại. 

      Việc này khác với thế tranh chấp ở quần đảo Senkaku. 

      Chúng tôi chỉ yêu cầu một bộ phận nhỏ của Hạm đội 7. 

      Cô định xăm tên chúa lên tay thế này à ? 

      Tổng thống có thể ban hành sắc lệnh trong trường hợp khẩn cấp. 

      Nhiệt độ quá cao, hệ thống chịu đựng quá giới hạn rồi. 

      Và chúc may mắn với cú ném tối nay, ngài phó tổng thống. 

      Liên quan đến việc đề cử chức bộ trưởng Bộ ngoại giao, phải không ? 
      
      </pre></div>
    </div>
    <div id="law" class="tab-pane fade">
      
      <div id="left" ><pre id='law-output' style="height: 300px;" class=syncscroll name=samplelaw>
      On the 20th of October 1994, the Government signed Decree No.177-CP promulgating the Statute on the Management of Investment and Construction (Statute on the Management of Investment and Construction 177-CP for short) as a substitute for the Statute on Capital Construction issued together with Decree No.385-HDBT on the 7th of November 1990 (Statute on Capital Construction 385-HDBT for short), and the Statute on the Drawing Up, Examination and Approval of the Designs of Construction Projects issued together with Decree No.237-HDBT on the 19th of September 1985 of the Council of Ministers.  

      In execution of Article 3 of the Decree, and Article 59 of the Statute on the Management of Investment and Construction 177-CP, the Ministry of Construction, the State Planning Committee and the Ministry of Finance hereunder guide the implementation of some main issues (outside the guidance on separate issues for the concerned ministries):  

      + With regard to the investment projects under State ownership, besides the management of the same aspects as in the investment projects of the non- State economic sector, the State shall also manage the commercial and financial aspects, and the economic efficiency of the project.  

      The State-owned investment projects comprise all the projects of which the investor (or his representative) is appointed by the competent authorities of the State, to manage the whole or part of the investment capital of the project raised from whatever source.  

      + The following investment projects shall come under separate guidance of the Ministries in charge of the branches after reaching agreement with the Ministry of Construction, the State Planning Committee and the Ministry of Finance: 
        
        </pre></div>

      <div id="right"><pre id='law-output' style="height: 300px;"  class=syncscroll name=samplelaw>
      Ngày 20/10/1994 Chính phủ đã ký Nghị định số 177/CP ban hành Điều lệ Quản lý đầu tư và xây dựng (gọi tắt là "điều lệ quản lý đầu tư và xây dựng 177/CP") thay thế Điều lệ quản lý xây dựng cơ bản ban hành kèm theo Nghị định số 385/HĐBT (gọi tắt là "Điều lệ quản lý XDCB 385/HĐBT) ngày 7/11/1990 và Điều lệ lập, thẩm tra, xét duyệt thiết kế các công trình xây dựng ban hành kèm theo Nghị định số 237/HĐBT ngày 19/9/1985 của Hội đồng Bộ trưởng. 

      Thực hiện Điều 3 của Nghị định và Điều 59 của Điều lệ Quản lý đầu tư và xây dựng 177/CP, liên Bộ (Bộ Xây dựng, Uỷ ban Kế hoạch Nhà nước, Bộ Tài chính) hướng dẫn chung một số vấn đề chủ yếu (ngoài những nội dung hướng dẫn riêng từng lĩnh vực của các bộ có liên quan) như sau:  

      - Đối với các dự án đâu tư thuộc sở hữu Nhà nước ngoài việc quản lý các mặt như đối với các dự án đầu tư của các thành phần kinh tế ngoài quốc doanh, Nhà nước còn quản lý về các khía cạnh thương mại, tài chính và hiệu quả kinh tế của dự án.

      Các dự án đầu tư thuộc sở hữu Nhà nước bao gồm tất cả các dự án mà chủ đầu tư (hoặc đại diện chủ đầu tư) do các cấp có thẩm quyền của Nhà nước cử ra hoặc thuê để quản lý toàn bộ hoặc một phần vốn đầu tư của dự án bất kể nguồn vốn đó được huy động từ đâu.  
      
      - Đối với các dự án đầu tư sâu đây sẽ có hướng dẫn riêng của Bộ quản lý ngành sau khi có sự thoả thuận của Liên Bộ Xây dựng - Uỷ ban Kế hoạch Nhà nước - Bộ Tài chính.  
      
      </pre></div>
    </div>
    <div id="medical" class="tab-pane fade">

      <div id="left" ><pre id='medical-output' style="height: 300px;" class=syncscroll name=samplemed>
      Surveying a number of factors on wound infection and the use of prophylactic antibiotics in surgical laparoscopic cholecystectomy.

      Hypertension is a risk factor for cardiovascular disease in industrialized countries as well as in our country, a cause of death among 12 leading causes of death in the elderly.

      Studying the combination of CEA and CA 19 - 9 levels with histopathological characteristics as well as monitoring recurrence and metastasis in patients with colorectal cancer.

      The meaning of introduce cut - off value of value plays an role as pilot study for the other relate study and brings the NT - ProBNP closely approach to clinical application.

      HPV DNA testing and HPV vaccines are milestones in the new era of primary, secondary and even tertiary prevention of cervical cancer.

      </pre></div>

      <div id="right"><pre id='medical-output' style="height: 300px;"  class=syncscroll name=samplemed>
      Khảo sát một số yếu tố về việc sử dụng kháng sinh dự phòng và nhiễm trùng vết mổ trong phẫu thuật nội soi cắt túi mật.

      Tăng huyết áp là một yếu tố nguy cơ cao đối với bệnh tim mạch ở các nước công nghiệp cũng như ở nước ta, đứng hàng đầu trong số 12 nguyên nhân gây tử vong ở người cao tuổi.

      Nghiên cứu mối liên quan kết hợp nồng độ CEA và CA 19 - 9 với các đặc điểm giải phẫu bệnh cũng như theo dõi tái phát và di căn ở bệnh nhân ung thư đại trực tràng.

      Việc đưa ra những điểm cắt tham khảo trong các bệnh lý tim mạch khác có ý nghĩa định hướng các nghiên cứu tiếp theo và đưa giá trị nồng độ NT - ProBNP vào thực tế lâm sàng nghiều hơn.

      Xét nghiệm ADN HPV và vaccin HPV mở ra một kỷ nguyên mới trong dự phòng sơ cấp, thứ cấp và cả tam cấp ung thư cổ tử cung.

      </pre></div>

    </div>
    <div id="book" class="tab-pane fade">
      
      <div id="left" ><pre id='book-output' style="height: 300px;" class=syncscroll name=samplebook>
      I wish I could have gone alone, Mary thought. I don't need him or anyone else to keep me out of trouble .

      The Romanian embassy looked completely different from the last time Mary had seen it. There was a festive air about it that had been totally missing on her first visit. They were greeted at the door by Gabriel Stoica, the deputy chief of mission .

      There was no flicker of recognition on Stoica's face .

      As they walked down the hallway, Mary noticed that all the rooms were brightly lighted and well heated. From upstairs she could hear the strains of a small orchestra. There were vases of flowers everywhere .
      
      Ambassador Corbescue was talking to a group of people when he saw James Stickley and Mary Ashley approach .
      
      </pre></div>

      <div id="right"><pre id='book-output' style="height: 300px;"  class=syncscroll name=samplebook>
      - Mình ước gì được đi một mình, - Mary nghĩ thế. - Mình không cần ông ta hoặc ai khác để mình khỏi phiền phức .

      Toà đại sứ Rumani trông hoàn toàn khác hẳn lần trước như Mary đã trông thấy. Có một bầu không khí tiệc tùng đã thiếu vắng trong chuyến đi thăm lần trước của nàng. Họ được Gabriel Stoica, phó trưởng phái bộ tiếp đón ở cửa .

      Chẳng có dấu hiệu nào tỏ vẻ nhận ra nàng trên nét mặt của Stoica .

      Trong khi họ bước xuống hành lang, Mary nhận thấy tất cả các phòng đều sáng rực và thật ấm áp. Từ trên lầu nàng có thể nghe những giai điệu của một ban nhạc nhỏ. Khắp nơi đều có các chậu hoa .

      Đại sứ Corbescue đang nói chuyện với một nhóm người khi ông ta trông thấy James Stickley và Mary Ashley đến gần .
        
      </pre></div>
    </div>

    <a href="https://console.cloud.google.com/storage/browser/vietai_public/best_vi_translation" class="button" target="_blank" rel="noopener noreferrer">Download data from <gcpstoragelogo>Storage</gcpstoragelogo></a>
  </div>

  <div style="height: 50px;"> </div>

  <h2> Quality of training data </h2>

  <p style="text-align:justify"> MultiCCAligned <dt-cite key="el2019ccaligned"></dt-cite> 
    massively crawled the Web and
    aligned bilingual texts using the auto-metric of embedding-based document similarity.
  This results in 9.3M English-Vietnamese text pairs - 
  the largest collection available to the public at the moment
  <dt-fn>MultiCCAligned paper reported 12.4M pairs, we detected and removed duplicates,
    which accounted for nearly one quarter of their released data.
  </dt-fn>.
  However, auto-metric based alignment produces data of lower quality than our carefully
  hand curated collection, many pairs in MultiCCAligned are themselves
  machine translated.
  Training on MultiCCAligned, therefore, gives much lower BLEU score,
  while incorporating MultiCCAligned into our own data slightly degrades our result.
  </p>


  <script type="text/javascript">
    google.charts.load("current", {packages:['corechart', 'bar']});  //"corechart",
    google.charts.setOnLoadCallback(drawChart);
    function drawChart() {
      var data1 = google.visualization.arrayToDataTable([
      ['Train on', 'MultiCCAligned', 'MultiCCAligned + Ours', 'Ours'],
      // ['English to Vietnamese', 32.54, 40.24, 40.97],
      // ['Vietnamese to English', 27.29, 36.79, 37.91],
      ['English to Vietnamese', 32.98, 40.70, 40.97],
      ['Vietnamese to English', 27.37, 37.21, 37.91],
      // tst 2013
      // ['English to Vietnamese', 32.44, 35.67, 39.39],
      // ['Vietnamese to English', 29.26, 36.80, 42.75],
      ]);
      var options1 = {
        bar: {groupWidth: "70%"},
        legend: { position: "top" },
        colors: ['#75a3a3',
                '#c1c1c1',
                '#ff9900'
              ],
        plotOptions: {
          series: {fillOpacity: 0.1}
        },
        vAxis: {
          // title: 'Comparing BLEU score between different training datasets',
          bar: {groupWidth: "80%"},
          ticks: [25, 29, 33, 37, 41],
          // minValue: 35,
          viewWindow: {
              min: 25
              // ,
              // max: [40, 45]
            }
        },
        animation: {
            "startup": true,
            "duration": 1000,
            easing: 'out',
        }
    };
      var chart1 = new google.visualization.ColumnChart(document.getElementById('chart_quality'));
      chart1.draw(data1, options1);
  }
  </script>

  <div>
    <div id="chart_quality" style="height: 300px;"></div>
  </div>

  <div style="height: 50px;"> </div>

  <h2> Training with language style conditioning </h2>
  
  <p style="text-align:justify">
    Machine Translation models are trained on many pairs of parallel sentences,
    and generally improve as more training data is included. 
    Their translation, however, usually converges towards a generic style. This is because of 
    a lack in context and a lack in user control to the model output. The first problem
    can be solved by simply inputting a larger chunk of text to translate. 
    To solve for the second problem,
    we trained the models while attaching the information of language styles to each example.
    This results in a further boost in performance in both directions of translation:
  </p>

  <div>
    <div id="chart_taguntag" style="height: 300px;"></div>
    <a href="https://colab.research.google.com/drive/1ISOSve7KrStffohgnjiLFs0cWEYqz9Tc?usp=sharing" class="button" target="_blank" rel="noopener noreferrer">Reproduce in <colablogo>Notebook</colablogo></a>
  </div>
      

  <div style="height: 20px;"></div>


<h2>Stylizing the Translation</h2>
<p style="text-align:justify">On the Movie Subtitle test set, 
  we observe an increase of nearly +2.0 points in BLEU score after attaching the style information. 
  To stylize a translation, simply append the style name after the input.
  Here is an example translated by our model from English to Vietnamese,
  using three different styles of language:
</p>


<ul class="nav nav-tabs">
  <li class="active"><a data-toggle="tab" id="what" href="#generic">Generic</a></li>
  <li><a data-toggle="tab" href="#movie1">Movie</a></li>
  <li class="tab"><a data-toggle="tab" href="#ted1">TED talks</a></li>
</ul>
  

<div class="tab-content" style="height: 130px;">
  <div id="generic" class="tab-pane fade in active">
    <div id="left" ><p style='height: 10px;'>Input to the model</p>
      <pre id='ted-output' style="height: 50px;" class=syncscroll name=style1>
I love you, harry
    </pre></div>
    <div id="right"><p style='height: 10px;'>Output of the model</p>
      <pre id='ted-output' style="height: 50px;"  class=syncscroll name=style1>
Em yêu anh, harry
    </pre></div>
  </div>
  <div id="movie1" class="tab-pane fade">
    <div id="left" ><p style='height: 10px;'>Input to the model</p>
      <pre id='ted-output' style="height: 50px;" class=syncscroll name=style2>
I love you, harry \ movie
    </pre></div>
    <div id="right"><p style='height: 10px;'>Output of the model</p>
      <pre id='ted-output' style="height: 50px;"  class=syncscroll name=style2>
Tôi yêu cô, harry
    </pre></div>
  </div>
  <div id="ted1" class="tab-pane fade">
    <div id="left" ><p style='height: 10px;'>Input to the model</p>
      <pre id='ted-output' style="height: 50px;" class=syncscroll name=style3>
I love you, harry \ TED talk 
    </pre></div>
    <div id="right"><p style='height: 10px;'>Output of the model</p>
      <pre id='ted-output' style="height: 50px;"  class=syncscroll name=style3>
Tôi yêu bạn, harry
    </pre></div>
  </div>
</div>

<div><a href="https://colab.research.google.com/drive/1BOqSEeNhF8azwDWsNzHBA1_aZvVPpA5g?usp=sharing" class="button" target="_blank" rel="noopener noreferrer">Try more in <colablogo>Notebook</colablogo></a></div>

<div style='height: 50px;'></div>
<h2>More details</h2>


<div><p style='height: 10px;'><b> Data collection </b></p></div>

<p style="text-align:justify"> Roughly half of our data was obtained from
  the Open Parallel Corpus collection<dt-cite key="TIEDEMANN12.463,schwenk2019wikimatrix,reimers-2020-multilingual-sentence-bert,christodouloupoulos2015massively,lison2016opensubtitles2016"></dt-cite>. 
  We perform simple processing on this collection by removing duplicates,
  filtering test data, and re-balancing the number of training examples from
  each language style.</p>
  <p style="text-align:justify">
  The second half was collected by scraping from multiples sources 
  on the Internet using the python packages <code>Selenium Webdriver</code> 
  and <code>BeautifulSoup4</code>. More details on the individual data sources
  and aligning algorithms can be found
  <a href="https://github.com/vietai/SAT/blob/main/scrape_sources.txt"
   target="_blank" rel="noopener noreferrer">here</a>. 
    Different data sources need different treatments, 
    we therefore spend most of our time on this step.
  </p>

<div><p style='height: 10px;'><b> Data Augmentation </b></p></div>
<p style="text-align: justify;">
We augmented the training dataset using two techniques: (1) concatenating
adjacent sentences up to a specified maximum length and (2) adding style information
to the training examples.
</p> 


<ul class="nav nav-tabs">
  <li class="active"><a data-toggle="tab" id="what" href="#original">Original</a></li>
  <li><a data-toggle="tab" href="#append">Concatenation</a></li>
  <li><a data-toggle="tab" href="#tag">Style tagging</a></li>
  <li><a data-toggle="tab" href="#combine">Combined</a></li>
</ul>
  

<div class="tab-content" style="height: 200px;">
  <div id="original" class="tab-pane fade in active">
    <div id="left">
      <pre id='ted-output' style="height: 180px;" class=syncscroll name=style1>
Hi there
How are you today?
I love you, harry
    </pre></div>
    <div id="right">
      <pre id='ted-output' style="height: 180px;"  class=syncscroll name=style1>
Chào anh
Hôm nay cô thế nào?
Tôi yêu cô, harry
    </pre></div>
  </div>  
  <div id="append" class="tab-pane fade">
    <div id="left" >
      <pre id='ted-output' style="height: 180px;" class=syncscroll name=style2>
Hi there
Hi there. How are you today?
Hi there. How are you today? I love you, harry
How are you today?
How are you today? I love you, harry
I love you, harry
    </pre></div>
    <div id="right">
      <pre id='ted-output' style="height: 180px;"  class=syncscroll name=style2>
Chào anh
Chào anh. Hôm nay cô thế nào?
Chào anh. Hôm nay cô thế nào? Tôi yêu cô, harry
Hôm nay cô thế nào?
Hôm nay cô thế nào? Tôi yêu cô, harry
Tôi yêu cô, harry
    </pre></div>
  </div>
  <div id="tag" class="tab-pane fade">
    <div id="left" >
      <pre id='ted-output' style="height: 180px;" class=syncscroll name=style3>
Hi there
Hi there \ movie
Hi there
How are you today?
How are you today? \ movie
How are you today?
I love you, harry
I love you, harry \ movie
I love you, harry
    </pre></div>
    <div id="right">
      <pre id='ted-output' style="height: 180px;"  class=syncscroll name=style3>
Chào anh
Chào anh
Chào anh \ phim
Hôm nay cô thế nào?
Hôm nay cô thế nào?
Hôm nay cô thế nào? \ phim
Tôi yêu cô, harry
Tôi yêu cô, harry
Tôi yêu cô, harry \ phim
    </pre></div>
  </div>

  <div id="combine" class="tab-pane fade">
    <div id="left" >
      <pre id='ted-output' style="height: 180px;" class=syncscroll name=style4>
Hi there
Hi there \ movie
Hi there
Hi there. How are you today?
Hi there. How are you today? \ movie
Hi there. How are you today?
Hi there. How are you today? I love you, harry
Hi there. How are you today? I love you, harry \ movie
Hi there. How are you today? I love you, harry
How are you today?
How are you today? \ movie
How are you today?
How are you today? I love you, harry
How are you today? I love you, harry \ movie
How are you today? I love you, harry
I love you, harry
I love you, harry \ movie
I love you, harry
    </pre></div>
    <div id="right">
      <pre id='ted-output' style="height: 180px;"  class=syncscroll name=style4>
Chào anh
Chào anh
Chào anh \ phim
Chào anh. Hôm nay cô thế nào?
Chào anh. Hôm nay cô thế nào?
Chào anh. Hôm nay cô thế nào? \ phim
Chào anh. Hôm nay cô thế nào? Tôi yêu cô, harry
Chào anh. Hôm nay cô thế nào? Tôi yêu cô, harry
Chào anh. Hôm nay cô thế nào? Tôi yêu cô, harry \ phim
Hôm nay cô thế nào?
Hôm nay cô thế nào?
Hôm nay cô thế nào? \ phim
Hôm nay cô thế nào? Tôi yêu cô, harry
Hôm nay cô thế nào? Tôi yêu cô, harry
Hôm nay cô thế nào? Tôi yêu cô, harry \ phim
Tôi yêu cô, harry
Tôi yêu cô, harry
Tôi yêu cô, harry \ phim
    </pre></div>
  </div>
</div>

<p style="text-align: justify;">
  Concatenation creates a uniform distribution
  of sentence lengths in our dataset, which
  helps debiasing the model 
  from long or short sentences. Style tagging creates three types of training examples (1) translation, (2) translation given a style and (3) translation + style classification. The learning, therefore, becomes multi-task learning and the model improves in its original task of translation. Combining the two data augmentations also
  multiplied our dataset of size 3.3M to roughly 25M pairs.</p>

  <div><p style='height: 10px;'><b> Modeling and training </b></p></div>

<p style="text-align: justify;">
  The deep learning model we used is Transformer 
  <dt-cite key="vaswani2017attention"></dt-cite>, with setting <code>transformer_base</code> of roughly 55M parameters. 
  Each translation model is trained with 1M training steps of batch size 32 (i.e. ~1.3 epoch), on 8 TPUv2 cores for roughly 2 days.
  We make extensive use of the code infrastructure from <code>vietai/dab</code> <dt-cite key="trieu19backtranslate"></dt-cite>
  for training and inference on Google Cloud resources.
  The core libraries are <code>tensor2tensor</code><dt-cite key="tensor2tensor"></dt-cite>, and <code>tensorflow</code><dt-cite key="abadi2016tensorflow"></dt-cite>.
</p>


  <h2>Refer to this work: </h2>
  <div><pre id='Bibtex' style="height: 150px;" class=syncscroll name=BibTex>
@article{sat2021ngo,
  author  = {Chinh Ngo and Trieu H. Trinh},
  title   = {Styled Augmented Translation (SAT)},
  journal = {https://github.com/vietai/SAT},
  year    = {2021},
}
    </pre></div>
  
</dt-article>
  <dt-appendix>
  <h3>Acknowledgement</h3>
  <p>Cloud computing resources are generously provided by VietAI (vietai.org).
    Special thanks to invaluable guidances from VietAI advisors Thang Luong, Thu Nguyen, and Phat Hoang.
  </p>
  <p>This article template is a fork of Distill.pub</p>
  </dt-appendix>

  <script type="text/bibliography">
    @article{trieu19backtranslate,
      author  = {Trieu H. Trinh and Thang Le and Phat Hoang and Minh{-}Thang Luong},
      title   = {A Tutorial on Data Augmentation by Backtranslation (DAB)},
      journal = {https://github.com/vietai/dab},
      year    = {2019},
    }
    @inproceedings{abadi2016tensorflow,
      title={Tensorflow: A system for large-scale machine learning},
      author={Abadi, Mart{\'\i}n and Barham, Paul and Chen, Jianmin and Chen, Zhifeng and Davis, Andy and Dean, Jeffrey and Devin, Matthieu and Ghemawat, Sanjay and Irving, Geoffrey and Isard, Michael and others},
      booktitle={12th $\{$USENIX$\}$ symposium on operating systems design and implementation ($\{$OSDI$\}$ 16)},
      pages={265--283},
      year={2016}
    }
      @article{tensor2tensor,
        author    = {Ashish Vaswani and Samy Bengio and Eugene Brevdo and
          Francois Chollet and Aidan N. Gomez and Stephan Gouws and Llion Jones and
          \L{}ukasz Kaiser and Nal Kalchbrenner and Niki Parmar and Ryan Sepassi and
          Noam Shazeer and Jakob Uszkoreit},
        title     = {Tensor2Tensor for Neural Machine Translation},
        journal   = {CoRR},
        volume    = {abs/1803.07416},
        year      = {2018},
        url       = {http://arxiv.org/abs/1803.07416},
      }
      @article{vaswani2017attention,
        title={Attention is all you need},
        author={Vaswani, Ashish and Shazeer, Noam and Parmar, Niki and Uszkoreit, Jakob and Jones, Llion and Gomez, Aidan N and Kaiser, Lukasz and Polosukhin, Illia},
        journal={arXiv preprint arXiv:1706.03762},
        year={2017}
      }
      @article{el2019ccaligned,
        title={CCAligned: A massive collection of cross-lingual web-document pairs},
        author={El-Kishky, Ahmed and Chaudhary, Vishrav and Guzman, Francisco and Koehn, Philipp},
        journal={arXiv preprint arXiv:1911.06154},
        year={2019}
      }
      @inproceedings{tiedemann-2012-parallel,
        title = "Parallel Data, Tools and Interfaces in {OPUS}",
        author = {Tiedemann, J{\"o}rg},
        booktitle = "Proceedings of the Eighth International Conference on Language Resources and Evaluation ({LREC}'12)",
        month = may,
        year = "2012",
        address = "Istanbul, Turkey",
        publisher = "European Language Resources Association (ELRA)",
        url = "http://www.lrec-conf.org/proceedings/lrec2012/pdf/463_Paper.pdf",
        pages = "2214--2218",
        abstract = "This paper presents the current status of OPUS, a growing language resource of parallel corpora and related tools. 
                    The focus in OPUS is to provide freely available data sets in various formats together with basic annotation to be 
                    useful for applications in computational linguistics, translation studies and cross-linguistic corpus studies. 
                    In this paper, we report about new data sets and their features, additional annotation tools and models provided 
                    from the website and essential interfaces and on-line services included in the project.",
    }
    
    @article{schwenk2019wikimatrix,
      title={Wikimatrix: Mining 135m parallel sentences in 1620 language pairs from wikipedia},
      author={Schwenk, Holger and Chaudhary, Vishrav and Sun, Shuo and Gong, Hongyu and Guzm{\'a}n, Francisco},
      journal={arXiv preprint arXiv:1907.05791},
      year={2019}
    }
    @inproceedings{reimers-2020-multilingual-sentence-bert,
      title = "Making Monolingual Sentence Embeddings Multilingual using Knowledge Distillation",
      author = "Reimers, Nils and Gurevych, Iryna",
      booktitle = "Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing",
      month = "11",
      year = "2020",
      publisher = "Association for Computational Linguistics",
      url = "https://arxiv.org/abs/2004.09813",
  }
  @InProceedings{TIEDEMANN12.463,
    author = {Jörg Tiedemann},
    title = {Parallel Data, Tools and Interfaces in OPUS},
    booktitle = {Proceedings of the Eight International Conference on Language Resources and Evaluation (LREC'12)},
    year = {2012},
    month = {may},
    date = {23-25},
    address = {Istanbul, Turkey},
    editor = {Nicoletta Calzolari (Conference Chair) and Khalid Choukri and Thierry Declerck and Mehmet Ugur Dogan and Bente Maegaard and Joseph Mariani and Jan Odijk and Stelios Piperidis},
    publisher = {European Language Resources Association (ELRA)},
    isbn = {978-2-9517408-7-7},
    language = {english}
   }
   @article{christodouloupoulos2015massively,
    title={A massively parallel corpus: the bible in 100 languages},
    author={Christodouloupoulos, Christos and Steedman, Mark},
    journal={Language resources and evaluation},
    volume={49},
    number={2},
    pages={375--395},
    year={2015},
    publisher={Springer}
  }
  @article{lison2016opensubtitles2016,
    title={Opensubtitles2016: Extracting large parallel corpora from movie and tv subtitles},
    author={Lison, Pierre and Tiedemann, J{\"o}rg},
    year={2016},
    publisher={European Language Resources Association}
  }
 </script>
</html>